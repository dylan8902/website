require 'rails_helper'

RSpec.describe SecurityVulnerability, :type => :model do

  before do
    @vulnerability = SecurityVulnerability.new(
      url: "http://url.com",
      domain: "url.com",
      fixed: false,
      summary: "summary",
      description: "description"
    )
  end

  describe "the summary" do

    it "should return placeholder text when not fixed" do
      @vulnerability.fixed = false
      expect(@vulnerability.summary).to eq("<p>Responsible disclosure has been made, awaiting a fix to be deployed before providing any details</p>")
    end

    it "should return summary when fixed" do
      @vulnerability.fixed = true
      expect(@vulnerability.summary).to eq("summary")
    end

  end

  describe "the description" do

    it "should return blank string when not fixed" do
      @vulnerability.fixed = false
      expect(@vulnerability.description).to eq("")
    end

    it "should return description when fixed" do
      @vulnerability.fixed = true
      expect(@vulnerability.description).to eq("description")
    end

  end

end
