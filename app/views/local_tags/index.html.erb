<% provide(:title, "Local Tags") %>
<% provide(:description, "Create a new tag where you are describing what you can see or do here or whatever.") %>
<% provide(:map, "map") %>

<h1>Local Tags</h1>

<section class="row">
	<article class="col-md-6">
		<div id="map" style="width:100%;height:400px"></div>
	</article>
	<article class="col-md-6">
		<%= render 'form' %>
	</article>
</section>

<script type="text/javascript">
	$(document).ready(function() {
		var lat = 53;
		var lng = -1;
		var center = new L.LatLng(lat, lng);
		var zoom = 8;
		var map = new L.Map('map');
		var cloudmade = new L.TileLayer('http://{s}.tile.cloudmade.com/778f546f046c4a63849269eb53d92a84/997/256/{z}/{x}/{y}.png', {
			attribution: 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery Â© <a href="http://cloudmade.com">CloudMade</a>',
			maxZoom: 18
		});
		map.setView(center, zoom).addLayer(cloudmade);

		if (navigator.geolocation != null) {
			navigator.geolocation.getCurrentPosition(function(position) {
				lat = position.coords.latitude;
				lng = position.coords.longitude;
				zoom = 14;
				center = new L.LatLng(lat, lng);
				map.setView(center, zoom);
			}, function(e) {
				alert(e.message);
			});
		}

		$('#local_tag_lat').val(lat); 
		$('#local_tag_lng').val(lng);
	});
</script>