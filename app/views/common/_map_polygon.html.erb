<script type="text/javascript">
	$(document).ready(function () {
		var map = new L.Map('map');
		var cloudmade = new L.TileLayer('http://{s}.tile.cloudmade.com/778f546f046c4a63849269eb53d92a84/997/256/{z}/{x}/{y}.png', {
			attribution: 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery Â© <a href="http://cloudmade.com">CloudMade</a>',
			maxZoom: 18
		});
		var center = new L.LatLng(<%= @locations.first.lat %>, <%= @locations.first.lng %>);
		map.setView(center, 6).addLayer(cloudmade);
		var p1, p2, line
		
	<% @locations.each_with_index do |location, i| %>
		<% next if i == 0 %>
		p1 = new L.LatLng(<%= location.lat %>, <%= location.lng %>);
		p2 = new L.LatLng(<%= @locations[i-1].lat %>, <%= @locations[i-1].lng %>);
		line = new L.Polygon([p1, p2]);
		map.addLayer(line);
	<% end %>
	});
</script>