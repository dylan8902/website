class SecurityVulnerability < ActiveRecord::Base
  validates :url, presence: true
  validates :domain, presence: true
  validates :summary, presence: true
  validates :description, presence: true
  default_scope { order('created_at DESC') }

  NOT_FIXED = "<p>Responsible disclosure has been made, awaiting a fix to be deployed before providing any details</p>"

  def fixed_label
    if fixed
      return "success"
    else
      return "danger"
    end
  end

  def fixed_label_text
    if fixed
      return "FIXED"
    else
      return "NOT FIXED"
    end
  end

  def summary
    if fixed
      return read_attribute(:summary)
    else
      return NOT_FIXED
    end
  end

  def description
    if fixed
      return read_attribute(:description)
    else
      return ""
    end
  end

  def to_s
    domain
  end

end
