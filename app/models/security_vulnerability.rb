class SecurityVulnerability < ApplicationRecord
  validates :url, presence: true
  validates :domain, presence: true
  default_scope { order('created_at DESC') }

  NOT_FIXED = "<p>Responsible disclosure has been made, awaiting a fix to be deployed before providing any details</p>"

  def fixed_label
    if fixed
      return "success"
    elsif wont_fix
      return "danger"
    else
      return "warning"
    end
  end

  def fixed_label_text
    if fixed
      return "FIXED"
    elsif wont_fix
      return "WON'T FIX"
    else
      return "NOT FIXED"
    end
  end

  def link_class
    if fixed | wont_fix
      return ""
    else
      return "obfuscate"
    end
  end

  def domain
    if fixed | wont_fix
      return self[:domain]
    else
      return "notyetfixed.com"
    end
  end

  def url
    if fixed | wont_fix
      return self[:url]
    else
      return "http://dyl.anjon.es/security-vulnerabilities"
    end
  end

  def summary
    if fixed | wont_fix
      return self[:summary]
    else
      return NOT_FIXED
    end
  end

  def description
    if fixed | wont_fix
      return self[:description]
    else
      return ""
    end
  end

  def to_s
    domain
  end

end
